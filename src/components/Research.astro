---
import {Icon} from "@astrojs/starlight/components";

const { id, title, authors, date, publisher, abstract, doi, link, other } =
    Astro.props;
const url = link ? link : doi ? `https://doi.org/${doi}` : null;
---

<div class="w-full mx-auto p-3 sm:p-5 border rounded-xl shadow-sm border-card bg-card hover:shadow-md transition-shadow duration-200">
    {/* ID Badge and Title */}
    <div class="flex flex-col sm:flex-row gap-2 sm:gap-3 sm:items-center">
        <span class="inline-block w-fit px-2 py-0.5 text-xs font-medium rounded bg-accent-low text-accent-high shrink-0">
            #{id}
        </span>
        <h3 class="my-0 text-base sm:text-lg font-semibold text-primary leading-snug">
            {title}
        </h3>
    </div>

    {/* Authors */}
    <div class="my-0 flex flex-wrap gap-x-1 gap-y-0.5 text-sm text-secondary">
        {authors.map((author: string, index: number) => (
            <span>
                {author}{index < authors.length - 1 ? "," : ""}
            </span>
        ))}
    </div>

    {/* Meta information */}
    <div class="my-0 flex flex-col sm:flex-row sm:items-center sm:gap-4 text-sm mb-3 pb-3 border-b border-card">
        {/* Publisher */}
        <span class="text-secondary">
            {publisher}
        </span>
        {/* Date */}
        <span class="text-tertiary">
            {date}
        </span>
        {/* DOI */}
        {doi && (
            <a
                href=`https://doi.org/${doi}`
                target="_blank"
                rel="noopener noreferrer"
                class="text-accent hover:underline transition-all duration-200 break-all"
            >
                DOI: {doi}
            </a>
        )}
    </div>

    {/* Notes */}
    {(other && other.length > 0) && (
        <ul class="mb-3 space-y-1">
            {other.map((item: string) => (
                <li class="text-sm text-accent">â€¢ {item}</li>
            ))}
        </ul>
    )}

    {/* Abstract */}
    <details class="group">
        <summary class="cursor-pointer text-sm font-medium text-secondary hover:text-accent transition-colors duration-200 list-none flex items-center gap-2">
            Abstract
        </summary>
        <div class="pl-4 sm:pl-6 space-y-2">
            {/* abstract */}
            <p class="text-sm leading-relaxed text-secondary">
                {abstract}
            </p>
            {/* read more */}
            {url && (
                <a
                    href={url}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex items-center gap-1 px-4 py-2 text-sm font-medium border rounded-lg hover:bg-accent hover:text-primary transition-all duration-200 no-underline"
                >
                    Read more
                    <Icon name="external" class="w-4 h-4" />
                </a>
            )}
        </div>
    </details>
</div>
